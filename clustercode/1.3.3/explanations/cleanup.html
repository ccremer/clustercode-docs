<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cleanup :: Clustercode Docs</title>
    <link rel="canonical" href="https://ccremer.github.io/clustercode-docs/clustercode/1.3.3/explanations/cleanup.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a href="https://ccremer.github.io/clustercode-docs">Clustercode Docs</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="clustercode" data-version="1.3.3">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Clustercode</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Introduction</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">How To</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../how-tos/install-docker.html">Install On Docker</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../how-tos/install-windows.html">Install On Windows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../how-tos/install-netdata.html">Install Netdata</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../how-tos/upgrade.html">Upgrade</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Technical reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../references/storage.html">Storage Settings</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../references/scan.html">Scan Settings</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../references/encoder.html">Encoder Settings</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../references/cluster.html">Cluster Settings</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../references/cleanup.html">Cleanup Settings</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../references/constraints.html">Constraints</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../references/api.html">API Settings</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Explanation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="storage.html">Storage</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="scan.html">Scan</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="encoder.html">Encoder</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cluster.html">Cluster</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="cleanup.html">Cleanup</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="constraints.html">Constraints</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="api.html">API</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Clustercode</span>
    <span class="version">1.3.3</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">Clustercode</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../index.html">master</a>
        </li>
        <li class="version">
          <a href="../../v2.0.0-rc3/index.html">v2.0.0-rc3</a>
        </li>
        <li class="version is-current">
          <a href="../index.html">1.3.3</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Clustercode</a></li>
    <li>Explanation</li>
    <li><a href="cleanup.html">Cleanup</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">1.3.3</button>
  <div class="version-menu">
    <a class="version is-missing" href="../../index.html">master</a>
    <a class="version is-missing" href="../../v2.0.0-rc3/index.html">v2.0.0-rc3</a>
    <a class="version is-current" href="cleanup.html">1.3.3</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/ccremer/clustercode/blob/1.3.3/docs/modules/ROOT/pages/explanations/cleanup.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Cleanup</h1>
<div class="sect1">
<h2 id="_enabled_cleanup_strategies"><a class="anchor" href="#_enabled_cleanup_strategies"></a>Enabled Cleanup Strategies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Specify a space-separated list of strategies that should be applied after encoding.
You should specify at least <code>MARK_SOURCE</code> and <code>UNIFIED_OUTPUT</code>, otherwise clustercode will not behave as you&#8217;d expect.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overwrite"><a class="anchor" href="#_overwrite"></a>Overwrite</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This flag controls whether existing files should be overwritten.
If set to <code>false</code>, a timestamp in the form of <code>yyyy-MM-dd.HH-mm-ss</code> will be added before the file extension.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cleanup_strategies"><a class="anchor" href="#_cleanup_strategies"></a>Cleanup Strategies</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_unified_output_directory"><a class="anchor" href="#_unified_output_directory"></a>Unified Output Directory</h3>
<div class="paragraph">
<p>Specify <code>UNIFIED_OUTPUT</code> to put all converted files into <code>/output</code> without any subdirectories.</p>
</div>
</div>
<div class="sect2">
<h3 id="_structured_output_directory"><a class="anchor" href="#_structured_output_directory"></a>Structured Output Directory</h3>
<div class="paragraph">
<p>Specify <code>STRUCTURED_OUTPUT</code> to recreate the input directory tree on the output root folder.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>/input/0/movie1.mp4</code> &#8594; <code>/output/movie.mp4</code></p>
</li>
<li>
<p><code>/input/1/movies/movie2.mkv</code> &#8594; <code>/output/movies/movie2.mkv</code></p>
</li>
<li>
<p><code>/input/1/movies/action/movie3.avi</code> &#8594; <code>/output/movies/action/movie3.mp4</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>The file extensions will be according to the profile.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mark_source"><a class="anchor" href="#_mark_source"></a>Mark Source</h3>
<div class="paragraph">
<p>Specify <code>MARK_SOURCE</code> to create the dummy file in the input folder next to the source file.
If this file exists, clustercode knows that the media file has already been processed and can be skipped in the next scan.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>For <code>/input/0/movie1.mp4</code> a file named <code>/input/0/movie1.mp4.done</code> will be created.</p>
</li>
<li>
<p>For <code>/input/0/series/sgnikiV/ep1.mp4</code> a file named <code>/input/0/series/sgnikiV/ep1.mp4.done</code> will be created.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mark_source_dir"><a class="anchor" href="#_mark_source_dir"></a>Mark Source Dir</h3>
<div class="paragraph">
<p>Specify <code>MARK_SOURCE_DIR</code> to create a dummy file similar to "Mark Source", but in its own directory specified by setting key <code>CC_CLEANUP_MARK_SOURCE_DIR</code>.
This strategy will leave your input folders as they are.
You could then mount the input folders as read-only, provided you change the default value for <code>CC_CLEANUP_MARK_SOURCE_DIR</code> (which is <code>/input/done</code>.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>For <code>/input/0/movie1.mp4</code> a file named <code>/input/done/0/movie1.mp4.done</code> will be created.</p>
</li>
<li>
<p>For <code>/input/0/series/sgnikiV/ep1.mp4</code> a file named <code>/input/done/0/series/sgnikiV/ep1.mp4.done</code> will be created.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_delete_source"><a class="anchor" href="#_delete_source"></a>Delete Source</h3>
<div class="paragraph">
<p>Specify <code>DELETE_SOURCE</code> as a strategy to delete the source files in the input directory.
Obviously clustercode cannot find the file on the next scan and will thus not be processed a second time.
Only use this option if you trust your ffmpeg profile.</p>
</div>
</div>
<div class="sect2">
<h3 id="_chown"><a class="anchor" href="#_chown"></a>Chown</h3>
<div class="paragraph">
<p>Specify <code>CHOWN</code> to change owner of the output file.
This strategy only works with Linux and if the current user is <code>root</code>.
The file will be changed with <code>chown CC_CLEANUP_CHOWN_USERID:CC_CLEANUP_CHOWN_GROUPID</code>.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<!--
This page was built using the Antora default UI.
The source code for this UI is licensed under the terms of the MPL-2.0 license.
->
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
